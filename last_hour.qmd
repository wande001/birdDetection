---
title: "Last Hour Observations"
execute:
  echo: false
---
## Last Hour Observations (confidence > 0.75)

```{python}
import pandas as pd
from datetime import datetime, timedelta

# --- Load Data ---
df = pd.read_csv("data/output.csv")

# --- Convert datetime ---
df['start'] = pd.to_datetime(df['timestamp'])

# --- Filter last hour ---
one_hour_ago = datetime.now() - timedelta(hours=3)
df_last_hour = df[df['start'] >= one_hour_ago]

# --- Filter high confidence ---
df_last_hour = df_last_hour[df_last_hour['confidence'] > 0.75]

# --- Aggregate counts per species ---
result = (
    df_last_hour
    .groupby("species")
    .size()
    .reset_index(name="count")
    .sort_values("count", ascending=False)
)

result
```