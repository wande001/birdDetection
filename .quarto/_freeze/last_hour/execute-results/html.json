{
  "hash": "db7916f220413544cce7b91fc382b286",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Last Hour Observations\"\n---\n\n\n\n## Last Hour Observations (confidence > 0.75)\n\n::: {#4a4a237d .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nfrom datetime import datetime, timedelta\n\n# --- Load Data ---\ndf = pd.read_csv(\"data/output.csv\")\n\n# --- Convert datetime ---\ndf['start'] = pd.to_datetime(df['timestamp'])\n\n# --- Filter last hour ---\none_hour_ago = datetime.now() - timedelta(hours=3)\ndf_last_hour = df[df['start'] >= one_hour_ago]\n\n# --- Filter high confidence ---\ndf_last_hour = df_last_hour[df_last_hour['confidence'] > 0.75]\n\n# --- Aggregate counts per species ---\nresult = (\n    df_last_hour\n    .groupby(\"species\")\n    .size()\n    .reset_index(name=\"count\")\n    .sort_values(\"count\", ascending=False)\n)\n\nresult\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>species</th>\n      <th>count</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3</th>\n      <td>Meerkoet</td>\n      <td>5</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Bosuil</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Kolgans</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Smient</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>Blauwe Reiger</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Roerdomp</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Wintertaling</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "last_hour_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}